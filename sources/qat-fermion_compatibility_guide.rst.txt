.. _qat-fermion_compatibility_guide:

Changelog
#########

Various improvements have been made in `MyQLM-fermion`. This includes new features, as well as many optimizations, bugfixes and
quality of life improvements. The list below can be used to update your :code:`qat.dqs` code.

Main updates
************

*   The module is now called :mod:`qat.fermion` (replaces :code:`qat.dqs`).

*   The :code:`qchem` submodule has been renamed :code:`chemistry` (:code:`qat.fermion.chemistry`).

*   :mod:`qat.fermion` is fully compatible with PySCF 2.0 version.

*   The :class:`~qat.fermion.hamiltonians.SpinHamiltonian` and :class:`~qat.fermion.hamiltonians.FermionHamiltonian` classes have been rewritten:

    * :class:`~qat.fermion.hamiltonians.FermionHamiltonian` now has a :meth:`~qat.fermion.hamiltonians.FermionHamiltonian.to_spin()` method to transform it into spin representation.

    * Fermionic algebraic operations are now possible between the fermionic Hamiltonians :class:`~qat.fermion.hamiltonians.FermionHamiltonian` and :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian`.

    * Wick ordering and subsequent simplifications are now automatic for fermionic Hamiltonians. Upon defining a :class:`~qat.fermion.hamiltonians.FermionHamiltonian`, its terms will be automatically normally ordered and simplified if possible.

    * It is now possible to cast a :class:`~qat.fermion.hamiltonians.FermionHamiltonian` to an :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian`, using the :meth:`~qat.fermion.hamiltonians.FermionHamiltonian.to_electronic()` method.

    * It is now possible to cast a :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian` to an :class:`~qat.fermion.hamiltonians.FermionHamiltonian`, using the :meth:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian.to_fermion()` method.

.. note::

    Since the :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian` inherits from
    :class:`~qat.fermion.hamiltonians.FermionHamiltonian`, any method available for
    :class:`~qat.fermion.hamiltonians.FermionHamiltonian` is available for
    :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian`.

*   Many improvements have been made to the chemistry module:

    *   the class :class:`~qat.fermion.chemistry.wrapper.MolecularHamiltonian` has been added. It allows for easier basis changes
    and active space selection. It also allows an easier transformation into
    :class:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian` using
    :meth:`~qat.fermion.chemistry.wrapper.MolecularHamiltonian.get_electronic_hamiltonian`.

    *   the class :class:`~qat.fermion.chemistry.wrapper.MoleculeInfo` has been added to help with atomic and molecular
    computations. It allows for an easier restriction of the active space of the studied system using
    :meth:`~qat.fermion.chemistry.wrapper.MoleculeInfo.restrict_active_space` method, which changes dynamically the relevant
    :class:`~qat.fermion.chemistry.wrapper.MoleculeInfo` attributes.

A set of new plugins is now available:

* :class:`~qat.plugins.AdaptVQEPlugin`: This plugin implements the ADAPT-VQE algorithm, to efficiently build an ansatz from a pool of operators,

* :class:`~qat.plugins.GradientDescentOptimizer`: Allows for natural gradient descent-based optimizations,

* :class:`~qat.plugins.SeqOptim`: An implementation of the quantum-classical hybrid sequential minimal optimization, method introduced by `Nakanashi et. al. <https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.2.043158>`_ has been added,

* :class:`~qat.plugins.ZeroNoiseExtrapolator`: A plugin helping with multiqubit gate noise mitigation,

* :class:`~qat.plugins.MultipleLaunchesAnalyzer`: A plugin allowing multiple optimizations for various random initial parameters at once.

Miscellanous
************

*   :code:`qat.dqs.fermionic_util` functions have now been included in :code:`qat.fermion.util`.

    *   the function :code:`exact_eigen_energies` has been deleted. Use any eigenvalue solver on the Hamiltonian matrix directly. You can
    generate the matrix using :meth:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian.get_matrix` method.

    *   the function :code:`fermionic_hamiltonian_exponential` has been deleted. Compute the exponential of the matrix obtained via
    :meth:`~qat.fermion.hamiltonians.ElectronicStructureHamiltonian.get_matrix` directly.

*   :code:`qat.dqs.impurity` models have been relocated in :code:`qat.fermion.hamiltonians`.

*   :code:`qat.dqs.ansatz_circuits` has been renamed :code:`qat.fermion.circuits`.

*   :code:`qat.dqs.qchem.ucc` has been renamed :code:`qat.fermion.chemistry.ucc`:

    *   :code:`build_ucc_ansatz` has been deprecated. It has been relocated to :code:`qat.fermion.chemistry.ucc_deprecated`, but the method
    :meth:`~qat.fermion.chemistry.ucc.construct_ucc_ansatz` in :code:`qat.fermion.chemistry.ucc` should be used instead. The underlying
    lower level methods have been clarified and can be used as well.

    *   :code:`compute_active_space_integrals` has been split into `_compute_active_space_constant` and `compute_active_space_integrals`.

    *   :code:`build_cluster_ops` is now a private method.

    *   :code:`select_active_orbitals` default threshold values have been updated.

    *   :code:`init_uccsd` is now a private method, and returns only the trial Mollet-Plesset 2nd order guess initial parameter.

    *   The :code:`get_initial_params_and_cluster_ops` function has been split into 3 separate functions for better clarity and maintenability:

        *   :code:`guess_init_params` to get the initial parameter guess computed via 2nd order Mollet-Plesset perturbation theory,

        *   :code:`get_hf_ket` to get the Hartree-Fock state,

        *   :code:`get_cluster_ops` to get the cluster operator list.

*   :code:`select_excitation_operators` and :code:`get_cluster_ops` have been updated. The deprecated versions are located in :code:`qat.fermion.chemistry.ucc_deprecated`.

*   :code:`get_active_space_hamiltonian` has been deprecated. It can still be found in :code:`qat.fermion.chemistry.ucc_deprecated`.