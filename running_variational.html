

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Running variational algorithms &mdash; myQLM documentation  documentation</title>
  

  
  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="static/contentui.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/doctools.js"></script>
        <script src="static/contentui.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="static/js/require.min.js"></script>
        <script async="async" src="static/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML,local/local"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Combinatorial optimization" href="combinatorial_optimization_intro.html" />
    <link rel="prev" title="Executing quantum circuits" href="simulating.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> myQLM documentation
          

          
            
            <img src="static/myqlm.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                myQLM-1.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basic usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/install.html">Installing myQLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="programming.html">Writing quantum circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulating.html">Executing quantum circuits</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running variational algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#variational-jobs">Variational jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#binding-variables">Binding variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Running variational algorithms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="combinatorial_optimization_intro.html">Combinatorial optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/interoperability.html">Interoperability with myQLM</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Main objects: Jobs, Observables, Circuits…</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulating.html">Building custom execution stacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_programming.html">Advanced programming using pyAQASM</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_combinatorial_optimization.html">Advanced combinatorial optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="source_doc.html">Source code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="aqasm.html">The AQASM format</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Command-line tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/notebooks.html">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/contrib.html">Contributing to myQLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="myqlm_specific/release-note.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">myQLM documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Running variational algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="running-variational-algorithms">
<span id="variational"></span><h1>Running variational algorithms<a class="headerlink" href="#running-variational-algorithms" title="Permalink to this headline">¶</a></h1>
<p>QLM comes with a collection of tools to efficiently describe and run variational quantum algorithm.
This page introduces the basic mechanics allowing you to write and run adaptive variational schemes.</p>
<p>For a more advanced usage <a class="reference internal" href="combinatorial_optimization_intro.html#combinatorial-optimization"><span class="std std-ref">Combinatorial optimization</span></a> describes a high-level interface to described combinatorial optimization problems and automatically
generate parametrized Ansätze.</p>
<div class="section" id="variational-jobs">
<h2>Variational jobs<a class="headerlink" href="#variational-jobs" title="Permalink to this headline">¶</a></h2>
<p>When running a variational quantum algorithm, we are, most of the time, interested in minimizing the energy of some observable <span class="math notranslate nohighlight">\(H\)</span> over some
parametrized quantum state <span class="math notranslate nohighlight">\(|\psi(\theta)\rangle\)</span>, i.e minimizing <span class="math notranslate nohighlight">\(\langle \psi(\theta)| H |\psi(\theta) \rangle\)</span>.</p>
<p>In the QLM, it is possible to build a variational quantum circuit by introducing open parameters in a pyAQASM <cite>Program</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">RY</span><span class="p">(</span><span class="n">variable</span><span class="p">)(</span><span class="n">qbits</span><span class="p">)</span>
<span class="n">RZ</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">variable</span><span class="p">)(</span><span class="n">qbits</span><span class="p">)</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables:&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>

<span class="n">job</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">to_job</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Job variables:&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Variables</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="n">Job</span> <span class="n">variables</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Additionally, the sampled observable itself can have parametrized coefficients:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qat.core</span> <span class="kn">import</span> <span class="n">Observable</span><span class="p">,</span> <span class="n">Term</span><span class="p">,</span> <span class="n">Variable</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observable</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># Obs = \sum_i \sigma_x^i</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">Observable</span><span class="o">.</span><span class="n">sigma_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observable variables:&quot;</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>

<span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">qbit</span> <span class="ow">in</span> <span class="n">qbits</span><span class="p">:</span>
    <span class="n">RY</span><span class="p">(</span><span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit variables:&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>

<span class="n">job</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">to_job</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Job variables:&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">Observable</span> <span class="n">variables</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">}</span>
<span class="n">Circuit</span> <span class="n">variables</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="n">Job</span> <span class="n">variables</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>This allows to have layered parametrized optimization, or even compilation tradeoffs where some variational parameters end up in the sampled observable.</p>
</div>
<div class="section" id="binding-variables">
<h2>Binding variables<a class="headerlink" href="#binding-variables" title="Permalink to this headline">¶</a></h2>
<p>Once we’ve built a parametrized job, its variables can be instantiated using the overloaded <cite>__call__</cite> operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>
<span class="kn">from</span> <span class="nn">qat.core</span> <span class="kn">import</span> <span class="n">Observable</span><span class="p">,</span> <span class="n">Term</span><span class="p">,</span> <span class="n">Variable</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observable</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">Observable</span><span class="o">.</span><span class="n">sigma_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">qbit</span> <span class="ow">in</span> <span class="n">qbits</span><span class="p">:</span>
    <span class="n">RY</span><span class="p">(</span><span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span><span class="o">.</span><span class="n">to_job</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>

<span class="n">job_2</span> <span class="o">=</span> <span class="n">job</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">job_2</span><span class="o">.</span><span class="n">observable</span><span class="p">)</span>

<span class="n">job_3</span> <span class="o">=</span> <span class="n">job</span><span class="p">(</span><span class="o">**</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">job</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">job_3</span><span class="o">.</span><span class="n">observable</span><span class="p">)</span>
<span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">job_3</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">iterate_simple</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
<span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
<span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="mf">0.5651967187660457</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
<span class="mf">0.5651967187660457</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
<span class="mf">0.5651967187660457</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">|</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RY&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.48210649510751047</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.9284259804300419</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RY&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.48210649510751047</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.9284259804300419</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RY&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.48210649510751047</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="p">(</span><span class="s1">&#39;RZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.9284259804300419</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When binding variables used inside a custom parametrized gate, a gate set containing the custom gate should be provided
via the <cite>gate_set</cite> kwargs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">AbstractGate</span>

<span class="n">XX</span> <span class="o">=</span> <span class="n">AbstractGate</span><span class="p">(</span><span class="s2">&quot;XX&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">XX</span><span class="p">(</span><span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">))(</span><span class="n">qbits</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">circuit_2</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Caught: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="n">circuit_2</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">gate_set</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">gate_set</span><span class="p">)</span>
<span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">circuit_2</span><span class="o">.</span><span class="n">iterate_simple</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;XX&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Running variational algorithms<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The simplest way to run a variational algorithm is to use a dedicated Plugin that will take care of the energy minimization.</p>
<p>The default variational Plugin wraps the <cite>scipy.optimize.minimize</cite> function: <a class="reference internal" href="variational-plugin.html#qat.plugins.ScipyMinimizePlugin" title="qat.plugins.ScipyMinimizePlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">qat.plugins.ScipyMinimizePlugin</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>
<span class="kn">from</span> <span class="nn">qat.core</span> <span class="kn">import</span> <span class="n">Observable</span><span class="p">,</span> <span class="n">Term</span><span class="p">,</span> <span class="n">Variable</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observable</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">Observable</span><span class="o">.</span><span class="n">sigma_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">qbit</span> <span class="ow">in</span> <span class="n">qbits</span><span class="p">:</span>
    <span class="n">RY</span><span class="p">(</span><span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span><span class="o">.</span><span class="n">to_job</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">qat.plugins</span> <span class="kn">import</span> <span class="n">ScipyMinimizePlugin</span>

<span class="n">optimize</span> <span class="o">=</span> <span class="n">ScipyMinimizePlugin</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;maxiter&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">})</span>

<span class="kn">from</span> <span class="nn">qat.qpus</span> <span class="kn">import</span> <span class="n">get_default_qpu</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">optimize</span> <span class="o">|</span> <span class="n">get_default_qpu</span><span class="p">()</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;final energy:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;best parameters:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trace:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;optimization_trace&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="n">energy</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.596890483978903</span>
<span class="n">best</span> <span class="n">parameters</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8398609335209911</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.8590495446211284</span><span class="p">]</span>
<span class="n">trace</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.12190285418119565</span><span class="p">,</span> <span class="mf">0.37387026135910517</span><span class="p">,</span> <span class="mf">0.8549514845173052</span><span class="p">,</span> <span class="mf">0.2932878865809388</span><span class="p">,</span> <span class="mf">0.13427196610325914</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43038267491277876</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28132089752126377</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9246864869881846</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.157484165708314</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1183008378611223</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.726371247609614</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0811046339017416</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5902433096202695</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8651921885666964</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.751115525721453</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.9634122342912956</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.1104946392842967</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2392252274375073</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3740434827338652</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5076753098248306</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6357813605986307</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.572813562879186</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.7290295356978778</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.618044107973866</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.7983089539284567</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.866698890952822</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9278783868806872</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9970247349695542</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.065265158853493</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1333366107693905</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.201491548889666</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2696412090932254</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.3377838164276756</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4058940253723344</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4740533981444646</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.542173742423368</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.6103191993539214</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.678466074794825</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.7465949755145487</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.8147384899447156</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.8828757151971516</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9509469786085294</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.019077035897277</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.087177706798407</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.155007232236208</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.223097420713083</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.291035834899662</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.359054878886324</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.427091326361496</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.494806350882782</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.562560813468633</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.630312663417515</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.696835985298197</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.763848215379209</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.830430719697816</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.890837926724561</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.957694074315227</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.01838304372378</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.081790021503982</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.144848714136393</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.191206364926953</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.263464605325483</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.310064354103187</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.381907669779171</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.4410925290366965</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.512158970154726</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.578133060692994</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.646183933905736</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.714390436699453</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.782786418129346</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.851274232098103</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.919506618502297</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.987641333798139</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.055655459815886</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.123681182538535</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.1918563889360705</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.2600115402226875</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.328134394381028</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.395567620109478</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.46379481978569</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.531087235626892</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598980677131104</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.666266284693009</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.726567755470327</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.793209810218503</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.850905398570111</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.910252892518909</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.966629770839965</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.974214803262766</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.0749886975862</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.091745743984955</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.176138562704379</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.236743845171867</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.305446467082289</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.374833693572335</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.44404647950274</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.512299816232045</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5804186508898574</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.648460868564024</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.716632842673256</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.784809289268182</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.8529413747637555</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.921100905739434</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.98923457999442</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.057390518186295</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.125534816861283</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.193685957134273</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.26183355894335</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.329844384911228</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.398055628255248</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.466117061406504</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.534305438317999</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.602336990518985</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.670538924516919</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.73856736705202</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.806771764827658</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.874749046821702</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.942968356242773</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.010903389166034</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.079119908306357</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.14698776789</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.215144078798609</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.282991797743412</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.350953709243843</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.41886737580792</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.486094908296618</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.554450007339844</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.62111984399586</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.689834959950012</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.75546279532459</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.824747162811216</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.891334942165773</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.960212424028779</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.025232288600806</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.094399913689173</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.158326072875816</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.226562384719665</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.286754404236587</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.345659084094294</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.403219922115285</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.418217151757801</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.513894987465658</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.47355638201586</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.510297243911014</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.528172421291032</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.540067643336759</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.482289542903025</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.56256636995478</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.58062565696413</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.596890483978903</span><span class="p">]</span>
</pre></div>
</div>
<p>This plugin also supports a nice feature: it can read optimization parameters directly from the job’s meta data. This allows you to build a stack with no particular choice of optimization parameters and attach these parameters directly to the job when submitting it. In this setting, the previous example becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">qat.lang.AQASM</span> <span class="kn">import</span> <span class="n">Program</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>
<span class="kn">from</span> <span class="nn">qat.core</span> <span class="kn">import</span> <span class="n">Observable</span><span class="p">,</span> <span class="n">Term</span><span class="p">,</span> <span class="n">Variable</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observable</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">Observable</span><span class="o">.</span><span class="n">sigma_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">()</span>
<span class="n">qbits</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">qalloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">qbit</span> <span class="ow">in</span> <span class="n">qbits</span><span class="p">:</span>
    <span class="n">RY</span><span class="p">(</span><span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">variable</span><span class="p">)(</span><span class="n">qbit</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">to_circ</span><span class="p">()</span><span class="o">.</span><span class="n">to_job</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">qat.plugins</span> <span class="kn">import</span> <span class="n">ScipyMinimizePlugin</span>

<span class="n">optimize</span> <span class="o">=</span> <span class="n">ScipyMinimizePlugin</span><span class="p">()</span>



<span class="kn">from</span> <span class="nn">qat.qpus</span> <span class="kn">import</span> <span class="n">get_default_qpu</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">optimize</span> <span class="o">|</span> <span class="n">get_default_qpu</span><span class="p">()</span>

<span class="n">optimizer_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tol&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
    <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;maxiter&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">meta_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ScipyMinimizePlugin&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">optimizer_args</span><span class="p">)})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;final energy:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;best parameters:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trace:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;optimization_trace&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="n">energy</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1646688333755821</span>
<span class="n">best</span> <span class="n">parameters</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.21376615928456932</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7889368905276677</span><span class="p">]</span>
<span class="n">trace</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.018185244192457015</span><span class="p">,</span> <span class="mf">0.9084440633798834</span><span class="p">,</span> <span class="mf">0.02811172375324955</span><span class="p">,</span> <span class="mf">0.5421860548850742</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1121839669278159</span><span class="p">,</span> <span class="mf">0.6100941943892162</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1591868261629538</span><span class="p">,</span> <span class="mf">0.1373914795828361</span><span class="p">,</span> <span class="mf">0.27134025441789217</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28646702285943293</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17396626656581643</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31031522894459823</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24658325782760887</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2725395789976864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3182964922326069</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3300257853867371</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34046186011490637</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3425839820213816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36265628232984604</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3681719628865662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.38291390168826234</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3963006131715023</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40933504005557053</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42199923105247006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43311609376853105</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4465869229610254</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4599431711975693</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.47266474330789254</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4858402911334594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4985251365686313</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5115812427707234</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5242475241861116</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5370949362929408</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5495166893907794</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5558453769150437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.57033326318938</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5703885366066108</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5820646006497211</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5890614554701925</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5937402736942401</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5852074676798339</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.599650094531424</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6054396632361128</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6085116960784678</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6163097299878159</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6205715112226818</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6276446691828421</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6340478732497841</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6405363633200702</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6469075503436581</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6514092038191309</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.658574151565953</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6635378649151986</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6705038407048982</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6766318443516937</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6832235369833018</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6898076376217561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6963199868348172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7028458972074276</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7093655166812594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7158367096318227</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7221471907960616</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7286696669044956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7352233197365223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7417856307068172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.748312281956228</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.754835943452901</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7613345060896894</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7678620845009472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7743837702212211</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7808985367386824</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.787426075606325</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7939511058170079</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8004141835570255</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8069492312792337</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.813439071113458</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8199728893129583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8264682143033025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.832991787411244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.839501870933046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8460243790821498</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.852538081093603</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8590259534242974</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8655577272187247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8720577046930627</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8785855409608518</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8851159682529006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8916399486735929</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8981647445844387</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9046581033536196</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9111941380289743</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.917698078313453</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9242304977429306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9307365314597842</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9372652788597398</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9437779354573768</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9503033065487221</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9568185539223564</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9633284790104559</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9698535810932011</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9763775196410397</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.982898011058353</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9893803971365509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9955156660160412</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0021629468801931</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0086977192852988</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0151592164447665</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.021668671957543</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.02812726195281</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0338951337551312</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0407045479044166</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.04710072977027</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0535882009189923</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0599927214607057</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.065298585500184</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0714791505924437</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0754755420831792</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0592834496171695</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.080689292442955</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0826796920997692</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0626542682455584</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.088026364210153</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.090911227373979</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0936120899709338</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0939238107664175</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0983969239252351</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1009324034026737</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1041010104456341</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1071435469517252</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1096832109975872</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1047992858319666</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1127762962170968</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1151794588990778</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1126358034762471</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1180315369342888</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1208646379134355</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.122339060144467</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1262723859835098</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1285731006624717</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1320253660351818</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1353200704362365</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.138578202277784</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.141830081945018</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1450938307338565</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1483578227682565</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.151620702289326</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.154883159261066</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.158145584375665</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1614056801112025</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1646688333755821</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="combinatorial_optimization_intro.html" class="btn btn-neutral float-right" title="Combinatorial optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="simulating.html" class="btn btn-neutral float-left" title="Executing quantum circuits" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Atos 2016-2021.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>